## 자바스크립트 엔진


![js-engine-runtime](https://user-images.githubusercontent.com/80687195/142749119-7db7f714-cee7-4e52-a153-d93989b76fdb.png)


자바스크립트 엔진은 `memory heap`과 `call stack`으로 구성되어 있습니다.  

`memory heap`이란 프로그래밍을 할 때 선언된 변수, 함수가 담겨지는 메모리 할당이 일어나는데 이때 메모리를 `memory heap`에 저장이 됩니다. 즉, 메모리 저장소입니다. 

`call stack`이란 자바스크립트에서 코드가 실행될 때 코드들이 stack의 형태도 차곡차곡 쌓이게 되고 맨위 상단에 있는 stack부터 코드가 실행되는 역할을 하는 특징이 있습니다. 

그래서 자바스크립트 엔진에서는 코드가 짜여진 순서대로 `call stack`에 차곡차곡쌓이게 되며, 어떤 변수를 만나게 되면 변수에 할당된 값을 `memory heap`에서 찾아 값을 반환해 주며, 가장 위 상단의 stack부터 실행되면서 `자바스크립트 엔진`이 돌아가게 됩니다. 

이때  **자바스크립트는 싱글 스레드 프로그래밍언어로 이 말은 즉, call stack이 한 개이며 한가지의 일만 처리할 수 있다는 뜻**입니다. 하지만 비동기 요청과 같은 동시성을 처리를 해야하는 경우가 생깁니다. 

웹브라우저에는 자바스크립트엔진말고도 `web APIs`, `callback queue`, `이벤트 루프`을 가지고 있습니다. 이러한 기능들을 이용하여 비동기 처리를 할 수 있게 됩니다. 

`web APIs`에서 제공하는 비동기 메서드들인 http요청, dom이벤트메서드, settimeout과 같은 메서드들이 호출되어 작동을 마치면 콜백함수는 `콜백큐(callback queue)`라는 곳에 순차적으로 들어가게 됩니다. 

이때는 가장먼저 들어간 함수가 가장 먼저나오는 형태입니다. 콜백큐에서 콜백함수가 나올 때 이벤트 루프가 작동이 되는데 

`이벤트 루프`란 call stack과 callback queue를 주시하고 있다가 call stack이 비워지게 되면 callback queue에 있는 콜백함수를 call stack에 밀어 넣어주게 됩니다. 

이렇게 자바스크립드 엔진과 비동기 호출은 브라우저에 이러한 작동으로 작동됩니다.
